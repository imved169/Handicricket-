
<!DOCTYPE html>
<html>
<head><title>Toss</title></head>
<body>
<h2>Toss in Progress...</h2>
<script type="module">
  import { db, ref, set } from './firebase_enhanced.js';

  const room = "demoRoom";
  const player1Team = JSON.parse(localStorage.getItem("player1Team"));
  const player2Team = JSON.parse(localStorage.getItem("player2Team"));

  set(ref(db, `rooms/${room}/players/player1`), {
    team: player1Team,
    ready: true
  });

  if (localStorage.getItem("aiMode") === "true") {
    set(ref(db, `rooms/${room}/players/player2`), {
      team: player2Team,
      ready: true
    });
  }

  // Random toss winner and choice
  const tossWinner = Math.random() < 0.5 ? "player1" : "player2";
  const choice = Math.random() < 0.5 ? "bat" : "bowl";

  set(ref(db, `rooms/${room}/toss`), {
    winner: tossWinner,
    choice: choice
  });

  setTimeout(() => {
    window.location.href = "game_enhanced.html";
  }, 1000);
</script>
</body>
</html>
